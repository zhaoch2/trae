function calculateFortune() {
    // 获取用户输入
    const name = document.getElementById('name').value;
    const gender = document.getElementById('gender').value;
    const birthdate = document.getElementById('birthdate').value;

    // 验证输入
    if (!name || !gender || !birthdate) {
        alert('请填写完整信息！');
        return;
    }

    // 计算星座和上升星座
    const date = new Date(birthdate);
    const month = date.getMonth() + 1;
    const day = date.getDate();
    const zodiacSign = getZodiacSign(month, day);
    const ascendantSign = calculateAscendantSign(date);

    // 生成运势分析
    const fortune = generateFortune(zodiacSign, ascendantSign, gender);

    // 显示结果
    document.getElementById('result').style.display = 'block';
    document.getElementById('summary').textContent = '🌟 ' + fortune.summary;
    document.getElementById('zodiac').textContent = '⭐ ' + fortune.zodiac;
    document.getElementById('ascendant').textContent = '🌙 ' + fortune.ascendant;
    document.getElementById('wealth').textContent = '💰 ' + fortune.wealth;
    document.getElementById('marriage').textContent = '💑 ' + fortune.marriage;
    document.getElementById('career').textContent = '💼 ' + fortune.career;
    document.getElementById('recent').textContent = '📅 ' + fortune.recent;
    document.getElementById('advice').textContent = '💡 ' + fortune.advice;
}

function getZodiacSign(month, day) {
    const dates = [
        [1, 20, '摩羯座'], [2, 19, '水瓶座'], [3, 20, '双鱼座'],
        [4, 20, '白羊座'], [5, 21, '金牛座'], [6, 21, '双子座'],
        [7, 23, '巨蟹座'], [8, 23, '狮子座'], [9, 23, '处女座'],
        [10, 23, '天秤座'], [11, 22, '天蝎座'], [12, 21, '射手座']
    ];

    let zodiac = '摩羯座';
    for (let i = 0; i < dates.length; i++) {
        if (month === dates[i][0] && day <= dates[i][1]) {
            zodiac = dates[i][2];
            break;
        }
        if (month === dates[i][0] && day > dates[i][1]) {
            zodiac = dates[(i + 1) % 12][2];
            break;
        }
    }
    return zodiac;
}

function calculateAscendantSign(birthDate) {
    // 简化的上升星座计算（实际占星需要更复杂的计算）
    const hour = birthDate.getHours();
    const signs = ['白羊座', '金牛座', '双子座', '巨蟹座', '狮子座', '处女座', 
                  '天秤座', '天蝎座', '射手座', '摩羯座', '水瓶座', '双鱼座'];
    const index = Math.floor(hour / 2) % 12;
    return signs[index];
}

function generateFortune(zodiacSign, ascendantSign, gender) {
    const zodiacInfo = {
        '摩羯座': '摩羯座性格务实稳重，做事认真负责，具有强烈的责任心和事业心。擅长规划和组织，追求成功的欲望强烈。',
        '水瓶座': '水瓶座思维独特，富有创造力和想象力，追求自由与独立。热衷于创新和改革，具有强烈的的人道主义精神。',
        '双鱼座': '双鱼座富有同情心和想象力，艺术感知力强，善解人意。直觉敏锐，容易被情感所触动。',
        '白羊座': '白羊座充满活力和勇气，性格直率豪爽，富有冒险精神。领导能力强，行动力出众。',
        '金牛座': '金牛座性格稳重可靠，意志力坚强，追求物质和精神的安定。做事踏实，具有良好的财务意识。',
        '双子座': '双子座思维敏捷，善于表达和沟通，知识面广泛。适应能力强，充满好奇心。',
        '巨蟹座': '巨蟹座重视情感和家庭，具有强烈的保护欲和同理心。记忆力强，重视传统。',
        '狮子座': '狮子座天生具有领袖气质，充满自信和魅力。慷慨大方，追求卓越。',
        '处女座': '处女座做事细心谨慎，逻辑分析能力强，追求完美。善于处理细节，具有批判性思维。',
        '天秤座': '天秤座追求和谐与平衡，具有良好的审美能力和社交才能。善于调解矛盾，追求公平。',
        '天蝎座': '天蝎座意志力坚强，洞察力敏锐，具有神秘魅力。感情专一，追求深度。',
        '射手座': '射手座乐观开朗，思想开放，追求自由和真理。见识广博，富有哲学思维。'
    };

    const ascendantInfo = {
        '摩羯座': '上升摩羯座的人给人可靠严谨的第一印象，行事作风稳重。',
        '水瓶座': '上升水瓶座的人展现出独特个性，常给人前卫新颖的印象。',
        '双鱼座': '上升双鱼座的人散发温柔神秘的气质，富有艺术感。',
        '白羊座': '上升白羊座的人展现出充沛的活力，给人积极进取的印象。',
        '金牛座': '上升金牛座的人给人踏实可靠的感觉，举止优雅。',
        '双子座': '上升双子座的人展现出灵活的交际能力，反应敏捷。',
        '巨蟹座': '上升巨蟹座的人给人温和亲切的感觉，情感丰富。',
        '狮子座': '上升狮子座的人散发出自信的光芒，容易成为焦点。',
        '处女座': '上升处女座的人给人干练整洁的印象，做事井井有条。',
        '天秤座': '上升天秤座的人展现出优雅和谐的气质，待人友善。',
        '天蝎座': '上升天蝎座的人散发神秘魅力，眼神深邃有力。',
        '射手座': '上升射手座的人给人开朗乐观的印象，充满活力。'
    };

    const philosophicalQuotes = [
        '命运如同手中的掌纹，虽已注定，但仍可以改变。',
        '星辰的轨迹指引方向，但人生的答案在于自己。',
        '生命如同星空，既有命定轨迹，也有无限可能。',
        '占星解密人生密码，智慧指引前方道路。'
    ];

    // 深度运势分析
    const detailedFortune = {
        wealth: generateDetailedWealth(zodiacSign),
        marriage: generateDetailedMarriage(zodiacSign),
        career: generateDetailedCareer(zodiacSign),
        recent: generateRecentFortune(zodiacSign),
        advice: generateDetailedAdvice(zodiacSign, ascendantSign)
    };

    return {
        summary: philosophicalQuotes[Math.floor(Math.random() * philosophicalQuotes.length)],
        zodiac: `${zodiacSign}：${zodiacInfo[zodiacSign]}`,
        ascendant: `上升星座${ascendantSign}：${ascendantInfo[ascendantSign]}`,
        ...detailedFortune
    };
}

function generateDetailedWealth(zodiacSign) {
    const wealthDetails = {
        '摩羯座': '近期财运稳健上升，适合进行长期投资规划。土星守护带来踏实的财运，建议在传统行业寻找机会。理财方面表现出色，善于资产配置。风险提示：避免过于保守，适当把握市场机会。',
        '水瓶座': '财运呈现波动上升趋势，创新项目容易带来意外收益。天王星的影响让你在投资时有独特的眼光。投资建议：保持适度冒险精神，但需要做好风险控制。',
        '双鱼座': '海王星的影响让你在艺术和创意产业有不错的财运。直觉敏锐，容易发现潜在的投资机会。建议：适当控制感性消费，增加对实体投资的关注。',
        '白羊座': '火星加持带来强劲财运，事业收入明显提升。投资方面魄力十足，但需要控制风险。短期投资机会多，把握时机很重要。',
        '金牛座': '金星守护让你的财运稳定增长，善于累积财富。房地产和奢侈品投资可能带来不错收益。建议：适当提高投资进取心，寻找新的增长点。',
        '双子座': '水星影响使财运多变，信息收集能力强。适合从事短线交易，但要注意市场风险。建议：分散投资，保持资金灵活性。',
        '巨蟹座': '月亮守护带来稳健财运，储蓄意识强。房地产投资可能带来良好收益。建议：增加对金融市场的关注，适当提高收益率。',
        '狮子座': '太阳照耀带来亮眼财运，大胆投资易有成效。领导能力带来额外收入机会。建议：控制投资规模，注意风险分散。',
        '处女座': '水星影响让财运细腻稳健，善于精打细算。专业技能可能带来额外收入。建议：适当扩大投资视野，寻找新的机会。',
        '天秤座': '金星守护使财运平衡发展，合作项目容易成功。人际关系可能带来投资机会。建议：注意合同细节，防范合作风险。',
        '天蝎座': '冥王星影响让财运充满变数，洞察先机能力强。适合进行深度投资研究。建议：控制投机心理，做好长期规划。',
        '射手座': '木星扩张带来乐观财运，国际投资可能获得收益。见识广博有助于把握市场机会。建议：注意控制投资节奏，防范风险。'
    };
    return wealthDetails[zodiacSign];
}

function generateDetailedMarriage(zodiacSign) {
    const marriageDetails = {
        '摩羯座': '感情生活稳定发展，重视承诺与责任。土星的影响让你在感情中较为谨慎，但也更加忠诚。近期桃花运平稳，已婚者家庭和睦，单身者可能通过工作认识理想对象。',
        '水瓶座': '感情观念前卫独特，追求自由的恋爱方式。天王星的影响让你在感情生活中充满新意。近期容易遇到志同道合的伴侣，网络社交可能带来缘分。',
        '双鱼座': '感情丰富细腻，容易陷入浪漫的恋情。海王星的影响让你在感情中充满幻想。近期感情运势起伏，需要保持清醒，避免过于理想化。',
        '白羊座': '感情态度积极主动，敢于表达真实想法。火星的影响让你在感情中充满激情。近期桃花运旺盛，但需要控制冲动，避免感情纠纷。',
        '金牛座': '感情生活追求稳定与安全感，重视物质基础。金星守护让你在感情中更显魅力。近期感情运势平稳，适合发展长期关系。',
        '双子座': '感情生活丰富多彩，社交圈广泛。水星的影响让你在感情中善于表达。近期可能遇到多桃花，需要及时做出选择。',
        '巨蟹座': '感情细腻敏感，重视家庭生活。月亮的影响让你特别注重情感交流。近期感情运势温和，家庭关系更加和谐。',
        '狮子座': '感情生活光鲜亮丽，享受被关注的感觉。太阳的影响让你在感情中充满自信。近期桃花运旺盛，容易吸引异性目光。',
        '处女座': '感情生活讲究条理，择偶标准较高。水星的影响让你对感情分析细致。近期感情运势平稳，需要放松心态。',
        '天秤座': '感情生活追求和谐，善于经营关系。金星的影响让你在感情中充满魅力。近期桃花运不错，容易发展稳定关系。',
        '天蝎座': '感情专注深刻，重视感情质量。冥王星的影响让你的感情充满神秘感。近期感情运势强烈，可能遇到刻骨铭心的恋情。',
        '射手座': '感情生活追求自由，享受恋爱过程。木星的影响让你在感情中保持乐观。近期异地恋或旅行桃花的可能性较大。'
    };
    return marriageDetails[zodiacSign];
}

function generateDetailedCareer(zodiacSign) {
    const careerDetails = {
        '摩羯座': '职业发展稳步上升，管理能力得到认可。土星守护让你工作态度认真负责，适合担任管理职位。近期事业运势良好，可能获得升职或加薪机会。建议：保持稳健作风，注重团队建设。',
        '水瓶座': '创新思维带来职业突破，适合从事科技创新领域。天王星影响让你想法备受关注。近期事业有新的发展机会，可能涉及新项目或创业。建议：保持独特视角，加强执行力。',
        '双鱼座': '艺术创意领域发展良好，直觉带来职业灵感。海王星影响增强你的艺术感知力。近期适合尝试新的工作方向，艺术相关项目大有可为。建议：平衡理想与现实。',
        '白羊座': '事业发展充满动力，领导才能得到发挥。火星加持带来充沛精力。近期工作节奏加快，可能面临重要决策机会。建议：控制脾气，注重细节。',
        '金牛座': '职业基础稳固，财务管理能力突出。金星守护让你在工作中展现魅力。近期事业稳定发展，可能获得稳定回报。建议：适度创新，拓展技能。',
        '双子座': '沟通能力带来职业优势，信息处理出色。水星影响让你思维敏捷。近期工作机会增多，社交活动助力事业。建议：提高专注度，深化专业知识。',
        '巨蟹座': '职业发展注重稳定，团队合作能力强。月亮影响增强你的共情能力。近期人际关系和谐，有利于项目推进。建议：增强独立性，提升决策力。',
        '狮子座': '事业发展光明，领导才能突出。太阳的影响让你容易获得关注。近期事业上升期，展现才能的机会增多。建议：保持谦逊，注重团队协作。',
        '处女座': '专业能力得到认可，工作细致认真。水星影响让你善于分析问题。近期工作压力较大，但收获也多。建议：放松心态，提高效率。',
        '天秤座': '职业发展平稳，人际关系和谐。金星守护让你善于协调关系。近期合作机会增多，有利于项目拓展。建议：增强决断力，把握机会。',
        '天蝎座': '事业发展深入，研究能力突出。冥王星影响让你洞察力强。近期可能遇到职业转折点，重要决策需谨慎。建议：控制权力欲，加强沟通。',
        '射手座': '事业视野开阔，发展机会多样。木星影响带来好运。近期容易获得贵人相助，事业有新突破。建议：脚踏实地，注重细节。'
    };
    return careerDetails[zodiacSign];
}

function generateRecentFortune(zodiacSign) {
    const recentDetails = {
        '摩羯座': '近期运势稳中向好，土星逆行结束带来事业机遇。工作中展现出色的组织能力，有望得到上级赏识。感情生活平稳，财运逐渐上升。建议把握投资机会，但需保持谨慎态度。',
        '水瓶座': '近期运势波动上扬，天王星带来意外惊喜。创新想法得到支持，新项目进展顺利。人际关系活跃，可能结识重要人士。投资方面需要控制风险，避免冲动决策。',
        '双鱼座': '近期运势起伏较大，海王星影响增强直觉。艺术创作灵感丰富，适合发展个人兴趣。感情方面需要保持清醒，避免过于理想化。财运方面宜稳健为主。',
        '白羊座': '近期运势强劲上升，火星加持带来充沛能量。事业上主动出击，容易获得成功。感情方面桃花旺盛，但需要控制脾气。投资机会多，注意风险把控。',
        '金牛座': '近期运势平稳向好，金星守护带来好运。事业发展稳定，收入有望提升。感情生活温馨，已婚者家庭和睦。投资理财宜保守，避免冒险。',
        '双子座': '近期运势多变积极，水星相位有利于学习和考试。工作中发挥口才优势，容易得到合作机会。感情方面选择增多，需要慎重决定。投资方面信息灵通，把握时机。',
        '巨蟹座': '近期运势温和上升，月亮守护增强情感共鸣。工作中展现团队协作能力，人际关系和谐。感情生活稳定，家庭关系更加亲密。理财方面宜稳健，注重积累。',
        '狮子座': '近期运势明朗上升，太阳带来好运气。事业发展顺利，容易成为关注焦点。感情方面魅力十足，单身者桃花旺盛。投资方面大胆谨慎结合。',
        '处女座': '近期运势稳步提升，水星助力专业发展。工作中表现专注，成果得到认可。感情生活规律，适合培养共同兴趣。理财方面细心规划，收益稳定。',
        '天秤座': '近期运势平衡向上，金星带来贵人运。事业中展现外交才能，容易获得合作机会。感情生活和谐，适合发展长期关系。投资方面需要平衡，避免极端。',
        '天蝎座': '近期运势神秘莫测，冥王星带来重要转折。事业可能面临关键选择，决策需要深思熟虑。感情方面有意外发展，保持警惕。投资方面机会与风险并存。',
        '射手座': '近期运势乐观ngood，木星带来幸运之星。事业发展机会增多，容易得到贵人相助。感情方面活跃，旅行中可能邂逅良缘。投资方面眼光独到，把握机遇。'
    };
    return recentDetails[zodiacSign];
}

function generateDetailedAdvice(zodiacSign, ascendantSign) {
    const adviceDetails = {
        '摩羯座': '建议：1. 工作中保持稳健作风，但要适当展现创造力。2. 感情上可以适当放松，增加生活情趣。3. 投资理财要放长眼光，做好资产配置。4. 注意劳逸结合，保持身心健康。',
        '水瓶座': '建议：1. 创新想法要注重落地执行。2. 社交圈要保持适度，避免过于分散精力。3. 投资可以关注新兴领域，但要控制风险。4. 感情上要增加真诚度，避免过于理性。',
        '双鱼座': '建议：1. 艺术创作要考虑实际需求。2. 感情上要保持一定理性，不要过于理想化。3. 投资理财需要实事求是。4. 工作中要提高执行力，避免拖延。',
        '白羊座': '建议：1. 行动前多思考，控制冲动。2. 感情上要增加耐心和体贴。3. 投资要做好风险评估。4. 工作中要注意团队协作。',
        '金牛座': '建议：1. 适当尝试新事物，突破舒适区。2. 感情上可以更加主动。3. 投资理财要适度进取。4. 工作中要展现创造力。',
        '双子座': '建议：1. 提高专注度，避免太过分散。2. 感情上要增加稳定性。3. 投资要做信息筛选。4. 工作中要深化专业知识。',
        '巨蟹座': '建议：1. 增强独立性，提升决策能力。2. 感情上要适当表达。3. 投资要走出保守。4. 工作中要勇于承担责任。',
        '狮子座': '建议：1. 保持谦逊，倾听他人建议。2. 感情上要增加体贴。3. 投资要控制规模。4. 工作中要注重细节。',
        '处女座': '建议：1. 放松完美主义，提高效率。2. 感情上要增加浪漫。3. 投资要开阔视野。4. 工作中要把握重点。',
        '天秤座': '建议：1. 增强决断力，减少犹豫。2. 感情上要明确立场。3. 投资要注意风险控制。4. 工作中要提高执行效率。',
        '天蝎座': '建议：1. 增加开放度，加强沟通。2. 感情上要适度表达。3. 投资要控制欲望。4. 工作中要团队协作。',
        '射手座': '建议：1. 提高执行力，注重细节。2. 感情上要增加稳定性。3. 投资要控制节奏。4. 工作中要脚踏实地。'
    };
    return adviceDetails[zodiacSign];
}